language:
  python
python:
  - "3.6"
  - "3.7"
  - "3.8"
  - "3.8-dev"  # 3.8 development branch
  - "nightly"  # nightly build
install:
  - python setup.py install
  - pip install "pytest>=5,<6"
script:
  # codegen for slack_sdk
  - python setup.py codegen
  # FIXME: the result can be different depending on OS platforms (e.g., macOS vs Linux)?
  # - if git status --porcelain | grep .; then git --no-pager diff; exit 1; fi
  # testing without aiohttp
  - travis_retry pytest tests/scenario_tests/
  - travis_retry pytest tests/slack_sdk_tests/
  # testing with aiohttp
  - pip install "pytest-asyncio<1" "aiohttp>=3,<4"
  - travis_retry pytest tests/scenario_tests_async/
  - travis_retry pytest tests/slack_sdk_tests_async/
  - export SLACKCLIENT_SKIP_DEPRECATION=1
  - travis_retry pytest tests/slack_sdk_tests_legacy/
  # run all tests just in case
  - travis_retry python setup.py test
